<!DOCTYPE html>
<html lang="en" data-theme="default"><!-- Put data-theme here on <html> -->
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="dark">
  <title>XSOAR Case Tools</title>

  <style>
    /******************************************************
     *  1) INTRO / LOADING SCREEN
     ******************************************************/
    #intro-screen {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: black;
      color: #00ff00;
      font-family: 'Courier New', Courier, monospace;
      text-align: center;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 1000;
    }
    #loading-text {
      font-size: 18px;
      white-space: nowrap;
      overflow: hidden;
      border-right: 2px solid #00ff00;
      width: 0;
      animation: typing 2s steps(30, end) forwards, blink 0.6s infinite alternate;
    }
    @keyframes typing {
      from { width: 0; }
      to { width: 100%; }
    }
    @keyframes blink {
      50% { border-color: transparent; }
    }

    /******************************************************
     *  2) MATRIX CANVAS
     ******************************************************/
    #matrix {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: -1;
      display: none; /* toggled by Red/Blue pill */
    }

    /******************************************************
     *  3) DEFAULT THEME
     ******************************************************/
    :root[data-theme="default"] {
      --bg-color: #1e1e1e;
      --text-color: #00ff00;
      --accent-color: #00ff00;
    }
    :root[data-theme="default"] body {
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: 'Courier New', Courier, monospace;
      transition: background-color 0.3s, color 0.3s;
    }

    /******************************************************
     *  4) CATPPUCCIN MOCHA THEME
     ******************************************************/
    :root[data-theme="mocha"] {
      /* Base Colors */
      --ctp-base: #1e1e2e;
      --ctp-text: #cdd6f4;

      /* Some accent variables */
      --ctp-blue: #89b4fa;
      --ctp-red: #f38ba8;
      --ctp-green: #a6e3a1;
      --ctp-mauve: #cba6f7;
      --ctp-teal: #94e2d5;
      --ctp-pink: #f5c2e7;
      --ctp-yellow: #f9e2af;
      --ctp-peach: #fab387;

      /* Default accent = Blue */
      --theme-color: var(--ctp-blue);

      /* We'll unify everything behind this one for borders, etc. */
      --accent-color: var(--theme-color);

      /* Overall background + text */
      --bg-color: var(--ctp-base);
      --text-color: var(--ctp-text);
    }
    :root[data-theme="mocha"] body {
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: 'JetBrains Mono', monospace;
      transition: background-color 0.3s, color 0.3s;
    }

    /******************************************************
     *  5) SHARED UI
     ******************************************************/
    body {
      margin: 0; padding: 0;
      text-align: center;
    }
    .tab-container {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 20px;
      margin-top: 10px;
    }
    .tab-button {
      background-color: black;
      color: var(--text-color);
      border: 2px solid var(--accent-color);
      padding: 8px 12px;
      cursor: pointer;
      min-width: 120px;
      text-align: center;
    }
    .tab-button:hover {
      background-color: var(--accent-color);
      color: black;
    }
    .tab-content {
      display: none;
      padding: 20px;
      border: 2px solid var(--accent-color);
      box-shadow: 0 0 10px var(--accent-color);
      max-width: 600px;
      margin: auto;
    }
    input, select, textarea {
      padding: 8px;
      margin: 5px;
      background-color: black;
      color: var(--text-color);
      border: 2px solid var(--accent-color);
      width: 100%;
      box-sizing: border-box;
    }
    button {
      padding: 8px 12px;
      background-color: black;
      color: var(--text-color);
      border: 2px solid var(--accent-color);
      cursor: pointer;
    }
    button:hover {
      background-color: var(--accent-color);
      color: black;
    }
    .cli-container {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      margin-top: 10px;
    }
    .cli-box {
      background-color: #222;
      padding: 10px;
      border: 2px solid var(--accent-color);
      box-shadow: 0 0 10px var(--accent-color);
      width: 48%;
      text-align: center;
    }
    textarea {
      width: 100%;
      height: 60px;
      background-color: black;
      color: var(--text-color);
      border: 1px solid var(--accent-color);
      resize: none;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      border: 2px solid var(--accent-color);
    }
    td {
      padding: 10px;
      border: 1px solid var(--accent-color);
      text-align: center;
    }
    hr {
      border: 1px solid var(--accent-color);
      margin: 20px 0;
    }

    /******************************************************
     *  6) MATRIX TOGGLE (RED/BLUE PILL)
     ******************************************************/
    .toggle-container {
      position: fixed;
      bottom: 15px; right: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
      background: rgba(0, 0, 0, 0.7);
      padding: 5px 10px;
      border: 1px solid var(--accent-color);
      border-radius: 5px;
    }
    .toggle-label {
      color: var(--accent-color);
      font-size: 14px;
      font-weight: bold;
    }
    .switch {
      position: relative;
      display: inline-block;
      width: 40px; height: 20px;
    }
    .switch input { opacity: 0; width: 0; height: 0; }
    .slider {
      position: absolute; cursor: pointer;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: blue; /* OFF = Blue Pill */
      border: 1px solid var(--accent-color);
      transition: .4s;
    }
    .slider:before {
      position: absolute; content: "";
      height: 14px; width: 14px;
      left: 3px; bottom: 3px;
      background-color: white;
      transition: .4s;
    }
    /* ON = Red Pill */
    input:checked + .slider {
      background-color: red;
    }
    input:checked + .slider:before {
      transform: translateX(18px);
    }
    .slider.square {
      border-radius: 4px;
    }

    /******************************************************
     *  7) THEME PICKERS (TOP-RIGHT)
     ******************************************************/
    #theme-controls {
      position: fixed;
      top: 10px; right: 10px;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 8px;
      background: rgba(0, 0, 0, 0.7);
      padding: 10px;
      border: 1px solid var(--accent-color);
      border-radius: 5px;
    }
    #theme-controls label {
      color: var(--accent-color);
      margin-right: 5px;
    }
    #accent-picker-container {
      display: none;
      margin-top: 5px;
    }
  </style>
</head>

<body>
  <!-- 1) BOOT-UP SCREEN -->
  <div id="intro-screen">
    <p id="loading-text">Initializing XSOAR Case Toolkit...</p>
  </div>

  <!-- 2) MATRIX CANVAS -->
  <canvas id="matrix"></canvas>

  <!-- 3) MATRIX TOGGLE -->
  <div class="toggle-container">
    <span class="toggle-label" id="pill-status">Blue Pill</span>
    <label class="switch">
      <input type="checkbox" id="toggle-matrix">
      <span class="slider square"></span>
    </label>
  </div>

  <!-- 4) THEME PICKERS (Catppuccin or Default) -->
  <div id="theme-controls">
    <div>
      <label for="theme-picker">Theme:</label>
      <select id="theme-picker">
        <option value="default">Default</option>
        <option value="mocha">Catppuccin Mocha</option>
      </select>
    </div>
    <div id="accent-picker-container">
      <label for="accent-picker">Accent:</label>
      <select id="accent-picker">
        <option value="blue">Blue</option>
        <option value="mauve">Mauve</option>
        <option value="teal">Teal</option>
        <option value="green">Green</option>
        <option value="pink">Pink</option>
        <option value="yellow">Yellow</option>
        <option value="peach">Peach</option>
        <option value="red">Red</option>
      </select>
    </div>
  </div>

  <h1>XSOAR Case Tools</h1>

  <div class="tab-container">
    <button class="tab-button" onclick="showTab('case-cli')">Case CLI</button>
    <button class="tab-button" onclick="showTab('case-flood')">Case Flood CLI</button>
    <button class="tab-button" onclick="showTab('case-notes')">Case Notes</button>
    <button class="tab-button" onclick="showTab('links-library')">Links Library</button>
  </div>

  <div id="case-cli" class="tab-content">
    <h2>Case CLI Generator</h2>
    <input type="text" id="case-id" placeholder="Enter Case ID">
    <button onclick="generateCaseCLI()">Generate CLI</button>
    <pre id="case-cli-output"></pre>
  </div>
  <div id="case-flood" class="tab-content">
    <h2>Case Flood CLI</h2>
    <p>Placeholder content for flooding CLI.</p>
  </div>
  <div id="case-notes" class="tab-content">
    <h2>Case Notes</h2>
    <textarea placeholder="Add your notes here..."></textarea>
  </div>
  <div id="links-library" class="tab-content">
    <h2>Links Library</h2>
    <p>Placeholder content for library of links.</p>
  </div>

  <script>
    /******************************************************
     * 1) BOOT SCREEN
     ******************************************************/
    setTimeout(() => {
      document.getElementById("intro-screen").style.display = "none";
    }, 3000);

    /******************************************************
     * 2) MATRIX EFFECT
     ******************************************************/
    const canvas = document.getElementById("matrix");
    const ctx = canvas.getContext("2d");

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ123456789@#$%^&*()*&^%";
    const matrix = letters.split("");
    const fontSize = 16;
    let columns = canvas.width / fontSize;
    const drops = Array.from({ length: columns }).fill(1);

    function drawMatrix() {
      ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      ctx.fillStyle = "#00ff00";
      ctx.font = fontSize + "px Courier New";

      drops.forEach((y, i) => {
        const text = matrix[Math.floor(Math.random() * matrix.length)];
        const x = i * fontSize;
        ctx.fillText(text, x, y * fontSize);

        if (y * fontSize > canvas.height && Math.random() > 0.975) {
          drops[i] = 0;
        }
        drops[i]++;
      });
    }
    setInterval(drawMatrix, 50);

    /******************************************************
     * 3) TAB HANDLER
     ******************************************************/
    function showTab(tabId) {
      document.querySelectorAll(".tab-content").forEach(tab => {
        tab.style.display = "none";
      });
      document.getElementById(tabId).style.display = "block";
    }

    /******************************************************
     * 4) MATRIX RED/BLUE PILL
     ******************************************************/
    document.addEventListener("DOMContentLoaded", function () {
      const toggle = document.getElementById("toggle-matrix");
      const pillStatus = document.getElementById("pill-status");

      // Start OFF
      document.getElementById("matrix").style.display = "none";
      toggle.checked = false;
      pillStatus.textContent = "Blue Pill";

      toggle.addEventListener("change", function () {
        if (this.checked) {
          // Red Pill => Show matrix
          document.getElementById("matrix").style.display = "block";
          pillStatus.textContent = "Red Pill";
        } else {
          // Blue Pill => Hide matrix
          document.getElementById("matrix").style.display = "none";
          pillStatus.textContent = "Blue Pill";
        }
      });
    });

    /******************************************************
     * 5) THEME PICKER + ACCENT PICKER
     ******************************************************/
    const themePicker = document.getElementById("theme-picker");
    const accentPicker = document.getElementById("accent-picker");
    const accentPickerContainer = document.getElementById("accent-picker-container");

    function updateAccentPickerVisibility(theme) {
      if (theme === "mocha") {
        accentPickerContainer.style.display = "block";
      } else {
        accentPickerContainer.style.display = "none";
      }
    }

    themePicker.addEventListener("change", () => {
      const selectedTheme = themePicker.value;
      // Put the attribute on <html>, so :root[data-theme="mocha"] matches
      document.documentElement.setAttribute("data-theme", selectedTheme);

      updateAccentPickerVisibility(selectedTheme);

      if (selectedTheme === "mocha") {
        setThemeAccent(accentPicker.value);
      }
    });

    accentPicker.addEventListener("change", () => {
      setThemeAccent(accentPicker.value);
    });

    function setThemeAccent(accentName) {
      // Overwrite --theme-color & --accent-color with the chosen accent
      // (We rely on e.g. var(--ctp-blue) from the CSS)
      document.documentElement.style.setProperty('--theme-color', `var(--ctp-${accentName})`);
      document.documentElement.style.setProperty('--accent-color', `var(--ctp-${accentName})`);
    }

    // Initialize
    updateAccentPickerVisibility(themePicker.value);

    /******************************************************
     * 6) EXAMPLE: Generate Case CLI
     ******************************************************/
    function generateCaseCLI() {
      const caseId = document.getElementById("case-id").value.trim();
      const output = document.getElementById("case-cli-output");
      if (!caseId) {
        output.textContent = "Please enter a Case ID.";
        return;
      }
      output.textContent = `demisto command --case ${caseId} --someOtherFlag ...`;
    }
    window.generateCaseCLI = generateCaseCLI; // expose for inline onclick
  </script>
</body>
</html>
