<!<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <meta name="color-scheme" content="dark">
  <title>XSOAR CLI Generator (Catppuccin Mocha Enhanced)</title>

  <style>
    /******************************************************************************
     *  1) CATPPUCCIN MOCHA PALETTE
     ******************************************************************************/
    :root {
      /* Mocha Base Colors */
      --ctp-rosewater: #f5e0dc;
      --ctp-flamingo:  #f2cdcd;
      --ctp-pink:      #f5c2e7;
      --ctp-mauve:     #cba6f7;
      --ctp-red:       #f38ba8;
      --ctp-maroon:    #eba0ac;
      --ctp-peach:     #fab387;
      --ctp-yellow:    #f9e2af;
      --ctp-green:     #a6e3a1;
      --ctp-teal:      #94e2d5;
      --ctp-sky:       #89dceb;
      --ctp-sapphire:  #74c7ec;
      --ctp-blue:      #89b4fa;
      --ctp-lavender:  #b4befe;

      /* Background / Foreground */
      --ctp-text:      #cdd6f4;
      --ctp-subtext1:  #bac2de;
      --ctp-subtext0:  #a6adc8;
      --ctp-overlay2:  #9399b2;
      --ctp-overlay1:  #7f849c;
      --ctp-overlay0:  #6c7086;
      --ctp-surface2:  #585b70;
      --ctp-surface1:  #45475a;
      --ctp-surface0:  #313244;
      --ctp-base:      #1e1e2e;
      --ctp-mantle:    #181825;
      --ctp-crust:     #11111b;

      /* Default accent color (can be changed by the accent picker) */
      --theme-accent: var(--ctp-blue);
    }

    /******************************************************************************
     *  2) PAGE & GLOBAL
     ******************************************************************************/
    body {
      margin: 20px;
      text-align: center;
      background-color: var(--ctp-base);
      color: var(--ctp-text);
      font-family: 'JetBrains Mono', monospace;
    }

    h1 {
      margin-bottom: 20px;
    }

    /* 
      Example: gradient text for the heading 
      (You can also just apply the gradient directly to h1 if you prefer)
    */
    .gradient-text {
      background: linear-gradient(90deg, var(--ctp-blue), var(--ctp-mauve));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /******************************************************************************
     *  3) FORM CONTAINER
     ******************************************************************************/
    .form-container {
      width: 50%;
      max-width: 700px;
      margin: auto;
      text-align: left;
      background-color: var(--ctp-mantle);
      border: 2px solid var(--theme-accent);
      box-shadow: 0 0 15px var(--theme-accent);
      padding: 20px;
      border-radius: 10px;
    }

    .field-container {
      margin: 10px 0;
    }

    label {
      display: block;
      margin-bottom: 5px;
      color: var(--ctp-subtext0);
    }

    /******************************************************************************
     *  4) INPUTS, SELECTS, TEXTAREAS
     ******************************************************************************/
    select,
    input,
    textarea {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
      background-color: var(--ctp-surface0);
      color: var(--ctp-text);
      border: 1px solid var(--theme-accent);
      border-radius: 4px; /* subtle rounding */
      transition: box-shadow 0.2s, border 0.2s;
    }

    textarea {
      resize: vertical;
      min-height: 40px;
    }

    input[type="datetime-local"] {
      background-color: var(--ctp-surface0);
      color: var(--ctp-text);
      border: 1px solid var(--theme-accent);
      padding: 8px;
      box-sizing: border-box;
    }

    /* Focus glow */
    select:focus,
    input:focus,
    textarea:focus {
      outline: none;
      border: 2px solid var(--theme-accent);
      box-shadow: 0 0 8px var(--theme-accent);
    }

    /******************************************************************************
     *  5) BUTTONS
     ******************************************************************************/
    .button-container {
      display: flex;
      justify-content: space-between;
    }

    button {
      flex: 1;
      padding: 10px;
      margin: 10px;
      background-color: var(--ctp-crust);
      color: var(--ctp-text);
      border: 2px solid var(--theme-accent);
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.2s, color 0.2s, transform 0.2s, box-shadow 0.2s;
      border-radius: 4px;
    }

    /* Enhanced hover effect */
    button:hover {
      background-color: var(--theme-accent);
      color: var(--ctp-crust);
      transform: scale(1.02);
      box-shadow: 0 0 10px var(--theme-accent);
    }

    /******************************************************************************
     *  6) CLI OUTPUT & COPY BUTTON
     ******************************************************************************/
    #cli-output {
      margin-top: 20px;
      padding: 10px;
      background-color: var(--ctp-surface1);
      color: var(--ctp-text);
      border: 2px solid var(--theme-accent);
      border-radius: 8px; /* subtle rounding */
      white-space: pre-wrap;
      word-wrap: break-word;
      min-height: 50px;
      font-family: 'Courier New', monospace;
      font-size: 0.95em;
      line-height: 1.4;
    }

    #copy-button {
      margin-top: 10px;
      background-color: var(--ctp-crust);
      color: var(--ctp-text);
      border: 2px solid var(--theme-accent);
      cursor: pointer;
      font-weight: bold;
      padding: 10px;
      width: 40%;
      display: block;
      margin-left: auto;
      margin-right: auto;
      transition: background-color 0.2s, color 0.2s, transform 0.2s, box-shadow 0.2s;
      border-radius: 4px;
    }
    #copy-button:hover {
      background-color: var(--theme-accent);
      color: var(--ctp-crust);
      transform: scale(1.02);
      box-shadow: 0 0 10px var(--theme-accent);
    }

    /******************************************************************************
     *  7) FOOTER
     ******************************************************************************/
    .footer {
      margin-top: 20px;
      font-size: 14px;
      color: var(--ctp-subtext0);
    }

    /******************************************************************************
     *  8) OPTIONAL: ACCENT PICKER
     ******************************************************************************/
    #accent-picker {
      background-color: var(--ctp-surface0);
      color: var(--ctp-text);
      border: 1px solid var(--theme-accent);
      border-radius: 4px;
      padding: 6px;
    }
  </style>
</head>

<body>

  <!-- Heading with gradient text -->
  <h1>
    <span class="gradient-text">XSOAR CLI Generator</span>
  </h1>

  <div class="form-container">
    <!-- Optional accent picker (demo) -->
    <div class="field-container">
      <label for="accent-picker">Theme Accent</label>
      <select id="accent-picker" onchange="updateAccent(this.value)">
        <option value="--ctp-blue">Blue</option>
        <option value="--ctp-mauve">Mauve</option>
        <option value="--ctp-teal">Teal</option>
        <option value="--ctp-red">Red</option>
      </select>
    </div>

    <form id="xsoar-cli-form">
      <div class="field-container">
        <label for="occurred-time">Occurred Time (UTC)</label>
        <input type="datetime-local" id="occurred-time">
      </div>

      <div class="field-container">
        <label for="majorincident">Major Incident</label>
        <select id="majorincident">
          <option value="no">No</option>
          <option value="yes">Yes</option>
        </select>
      </div>

      <div class="field-container">
        <label for="falsepositive">False Positive</label>
        <select id="falsepositive">
          <option value="no">No</option>
          <option value="yes">Yes</option>
        </select>
      </div>

      <div class="field-container">
        <label for="falsepositivenotes">False Positive Notes</label>
        <textarea id="falsepositivenotes">N/A</textarea>
      </div>

      <div class="field-container">
        <label for="classification">Classification</label>
        <select id="classification">
          <option value="Hacking">Hacking</option>
          <option value="Malware">Malware</option>
          <option value="Phishing">Phishing</option>
        </select>
      </div>

      <div class="field-container">
        <label for="escalationto">Escalation To</label>
        <select id="escalationto">
          <option value="N/A">N/A</option>
        </select>
      </div>

      <div class="field-container">
        <label for="attackvector">Attack Vector</label>
        <select id="attackvector">
          <option value="Other">Other</option>
        </select>
      </div>

      <div class="field-container">
        <label for="detectionsource">Detection Source</label>
        <select id="detectionsource">
          <option value="Custom Alert">Custom Alert</option>
        </select>
      </div>

      <div class="field-container">
        <label for="impact">Impact</label>
        <select id="impact">
          <option value="Not Malicious">Not Malicious</option>
        </select>
      </div>

      <div class="field-container">
        <label for="repeatoffendername">Repeat Offender Name</label>
        <textarea id="repeatoffendername">N/A</textarea>
      </div>

      <div class="field-container">
        <label for="signatureupdate">Signature Update</label>
        <textarea id="signatureupdate">N/A</textarea>
      </div>

      <div class="button-container">
        <button type="button" onclick="generateCLI()">Generate</button>
        <button type="reset">Reset</button>
      </div>
    </form>

    <div id="cli-output"></div>
    <button id="copy-button" onclick="copyToClipboard()">Copy</button>
  </div>

  <div class="footer">
    Made with ðŸ’š by Jeff Morris | Hack The Planet ðŸŒŽ
  </div>

  <script>
    /******************************************************************************
     *  1) ACCENT PICKER LOGIC
     ******************************************************************************/
    function updateAccent(colorVar) {
      // Overwrite --theme-accent with whichever var is selected
      // e.g. --ctp-blue, --ctp-mauve, etc.
      document.documentElement.style.setProperty('--theme-accent', `var(${colorVar})`);
    }

    /******************************************************************************
     *  2) TIMEZONE HELPER
     ******************************************************************************/
    function convertUTCToLocal(utcDateStr) {
      const utcDate = new Date(utcDateStr + "Z");
      const localDate = new Date(utcDate.getTime());

      const pad = (num) => num.toString().padStart(2, '0');
      const year = localDate.getFullYear();
      const month = pad(localDate.getMonth() + 1);
      const day = pad(localDate.getDate());
      const hours = pad(localDate.getHours());
      const minutes = pad(localDate.getMinutes());
      const seconds = pad(localDate.getSeconds());

      const offsetMinutes = localDate.getTimezoneOffset();
      const offsetHours = Math.abs(offsetMinutes / 60);
      const offsetSign = offsetMinutes > 0 ? "-" : "+";
      const offsetFormatted = `${offsetSign}${pad(offsetHours)}:${pad(offsetMinutes % 60)}`;

      return `${year}-${month}-${day}T${hours}:${minutes}:${seconds}${offsetFormatted}`;
    }

    /******************************************************************************
     *  3) GENERATE CLI
     ******************************************************************************/
    function generateCLI() {
      const occurredTimeInput = document.getElementById('occurred-time').value;
      let params = {
        majorincident: document.getElementById('majorincident').value,
        falsepositive: document.getElementById('falsepositive').value,
        falsepositivenotes: document.getElementById('falsepositivenotes').value,
        classification: document.getElementById('classification').value,
        escalationto: document.getElementById('escalationto').value,
        attackvector: document.getElementById('attackvector').value,
        detectionsource: document.getElementById('detectionsource').value,
        impact: document.getElementById('impact').value,
        repeatoffendername: document.getElementById('repeatoffendername').value,
        signatureupdate: document.getElementById('signatureupdate').value
      };

      if (occurredTimeInput) {
        const localTime = convertUTCToLocal(occurredTimeInput);
        params["remediationtime"] = localTime;
        params["containmenttime"] = localTime;
      }

      const cliCommand = "!setIncident " + Object.entries(params)
        .map(([key, value]) => `${key}="${value}"`)
        .join(' ');

      document.getElementById('cli-output').textContent = cliCommand;
    }

    /******************************************************************************
     *  4) COPY TO CLIPBOARD
     ******************************************************************************/
    function copyToClipboard() {
      const output = document.getElementById('cli-output').textContent;
      navigator.clipboard.writeText(output).then(() => {
        alert("CLI Command Copied!");
      });
    }
  </script>
</body>
</html>
